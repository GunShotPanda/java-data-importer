{
    "source":{
        "datasource":"impala0",
        "queryCommand":"SELECT from_unixtime(CAST(CAST(statistical_start_time AS BIGINT) / 3600 AS BIGINT) * 3600, 'yyyy-MM-dd HH:mm:ss') AS 'R_STATTIME' , COUNT(DISTINCT user_account) AS 'R_ONLINECOUNT' , CASE WHEN SUM(ISNULL(ul_ip_len, 0)) + SUM(ISNULL(dl_ip_len, 0)) > 1 * 1024 * 1024 THEN COUNT(DISTINCT user_account) ELSE 0 END AS 'R_ACTIVECOUNT' FROM gemstack.wb_total_kpi_15m_uid_host WHERE slicetime >= ? AND ? > slicetime AND statistical_start_time IS NOT NULL AND user_account IS NOT NULL GROUP BY 1",
        "firstQueryCommand":"",
        "trigger":{
            "timer":{
                "updateInterval":"60"
            },
            "messager":{
                "msgID":""
            }
        },
        "time":{
            "trim":{
                "mode":"MINUTE",
                "minute":"60"
            },
            "delay":"45",
            "timeslot":"60"
        }
    },
    "dest":[
	    {
            "type":"mysql",
            "datasource":"mysql1",
            "actions":[
                {
                    "sqlCommand":"INSERT INTO q_report_flow_useronline_h VALUES (?,?,?)",
                    "columns":[
          			        "R_STATTIME",
                            "R_ONLINECOUNT",
                            "R_ACTIVECOUNT"
                    ]
                }
            ]
        },
        {
            "type":"sqlserver",
            "datasource":"sqlserver0",
            "actions":[
                {
                    "sqlCommand":"INSERT INTO q_report_flow_useronline_h VALUES (?,?,?)",
                    "columns":[
                            "R_STATTIME",
                            "R_ONLINECOUNT",
                            "R_ACTIVECOUNT"
                    ]
                }
            ]
        },
        {
            "type":"FileSystem",
            "actions":[
                {
                    "datasource":"fileSys2",
                    "filename":"网调_18_q_report_flow_useronline_h-%startTime:yyyyMMddHH%_%endTime:yyyyMMddHH%.csv",
                    "finishedFilename":"网调_18_q_report_flow_useronline_h-%startTime:yyyyMMddHH%_%endTime:yyyyMMddHH%",
                    "compressor":""
                }
            ]
        }
    ]
}